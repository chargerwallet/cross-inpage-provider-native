!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(window,(function(){return(()=>{var e={422:e=>{"use strict";var t=Object.prototype.hasOwnProperty,n="~";function r(){}function o(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function i(e,t,r,i,s){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new o(r,i||e,s),c=n?n+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),a.prototype.eventNames=function(){var e,r,o=[];if(0===this._eventsCount)return o;for(r in e=this._events)t.call(e,r)&&o.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(e)):o},a.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var o=0,i=r.length,s=new Array(i);o<i;o++)s[o]=r[o].fn;return s},a.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},a.prototype.emit=function(e,t,r,o,i,s){var a=n?n+e:e;if(!this._events[a])return!1;var c,d,l=this._events[a],u=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),u){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,r),!0;case 4:return l.fn.call(l.context,t,r,o),!0;case 5:return l.fn.call(l.context,t,r,o,i),!0;case 6:return l.fn.call(l.context,t,r,o,i,s),!0}for(d=1,c=new Array(u-1);d<u;d++)c[d-1]=arguments[d];l.fn.apply(l.context,c)}else{var g,f=l.length;for(d=0;d<f;d++)switch(l[d].once&&this.removeListener(e,l[d].fn,void 0,!0),u){case 1:l[d].fn.call(l[d].context);break;case 2:l[d].fn.call(l[d].context,t);break;case 3:l[d].fn.call(l[d].context,t,r);break;case 4:l[d].fn.call(l[d].context,t,r,o);break;default:if(!c)for(g=1,c=new Array(u-1);g<u;g++)c[g-1]=arguments[g];l[d].fn.apply(l[d].context,c)}}return!0},a.prototype.on=function(e,t,n){return i(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return i(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,r,o){var i=n?n+e:e;if(!this._events[i])return this;if(!t)return s(this,i),this;var a=this._events[i];if(a.fn)a.fn!==t||o&&!a.once||r&&a.context!==r||s(this,i);else{for(var c=0,d=[],l=a.length;c<l;c++)(a[c].fn!==t||o&&!a[c].once||r&&a[c].context!==r)&&d.push(a[c]);d.length?this._events[i]=1===d.length?d[0]:d:s(this,i)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&s(this,t)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a},620:(e,t,n)=>{var r=n(19).Symbol;e.exports=r},325:(e,t,n)=>{var r=n(620),o=n(544),i=n(252),s=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":s&&s in Object(e)?o(e):i(e)}},8:e=>{var t="object"==typeof global&&global&&global.Object===Object&&global;e.exports=t},723:(e,t,n)=>{var r=n(539)(Object.getPrototypeOf,Object);e.exports=r},544:(e,t,n)=>{var r=n(620),o=Object.prototype,i=o.hasOwnProperty,s=o.toString,a=r?r.toStringTag:void 0;e.exports=function(e){var t=i.call(e,a),n=e[a];try{e[a]=void 0;var r=!0}catch(e){}var o=s.call(e);return r&&(t?e[a]=n:delete e[a]),o}},252:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},539:e=>{e.exports=function(e,t){return function(n){return e(t(n))}}},19:(e,t,n)=>{var r=n(8),o="object"==typeof self&&self&&self.Object===Object&&self,i=r||o||Function("return this")();e.exports=i},906:e=>{var t=Array.isArray;e.exports=t},920:(e,t,n)=>{var r=n(325),o=n(464);e.exports=function(e){if(!o(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},464:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},612:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},395:(e,t,n)=>{var r=n(325),o=n(723),i=n(612),s=Function.prototype,a=Object.prototype,c=s.toString,d=a.hasOwnProperty,l=c.call(Object);e.exports=function(e){if(!i(e)||"[object Object]"!=r(e))return!1;var t=o(e);if(null===t)return!0;var n=d.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&c.call(n)==l}},788:(e,t,n)=>{var r=n(325),o=n(906),i=n(612);e.exports=function(e){return"string"==typeof e||!o(e)&&i(e)&&"[object String]"==r(e)}},554:e=>{var t=1e3,n=60*t,r=60*n,o=24*r;function i(e,t,n,r){var o=t>=1.5*n;return Math.round(e/n)+" "+r+(o?"s":"")}e.exports=function(e,s){s=s||{};var a,c,d=typeof e;if("string"===d&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var i=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(i){var s=parseFloat(i[1]);switch((i[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"weeks":case"week":case"w":return 6048e5*s;case"days":case"day":case"d":return s*o;case"hours":case"hour":case"hrs":case"hr":case"h":return s*r;case"minutes":case"minute":case"mins":case"min":case"m":return s*n;case"seconds":case"second":case"secs":case"sec":case"s":return s*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}}}(e);if("number"===d&&isFinite(e))return s.long?(a=e,(c=Math.abs(a))>=o?i(a,c,o,"day"):c>=r?i(a,c,r,"hour"):c>=n?i(a,c,n,"minute"):c>=t?i(a,c,t,"second"):a+" ms"):function(e){var i=Math.abs(e);return i>=o?Math.round(e/o)+"d":i>=r?Math.round(e/r)+"h":i>=n?Math.round(e/n)+"m":i>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},439:e=>{e.exports=s,s.default=s,s.stable=l,s.stableStringify=l;var t="[...]",n="[Circular]",r=[],o=[];function i(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function s(e,t,n,s){var a;void 0===s&&(s=i()),c(e,"",0,[],void 0,0,s);try{a=0===o.length?JSON.stringify(e,t,n):JSON.stringify(e,g(t),n)}catch(e){return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;0!==r.length;){var d=r.pop();4===d.length?Object.defineProperty(d[0],d[1],d[3]):d[0][d[1]]=d[2]}}return a}function a(e,t,n,i){var s=Object.getOwnPropertyDescriptor(i,n);void 0!==s.get?s.configurable?(Object.defineProperty(i,n,{value:e}),r.push([i,n,t,s])):o.push([t,n,e]):(i[n]=e,r.push([i,n,t]))}function c(e,r,o,i,s,d,l){var u;if(d+=1,"object"==typeof e&&null!==e){for(u=0;u<i.length;u++)if(i[u]===e)return void a(n,e,r,s);if(void 0!==l.depthLimit&&d>l.depthLimit)return void a(t,e,r,s);if(void 0!==l.edgesLimit&&o+1>l.edgesLimit)return void a(t,e,r,s);if(i.push(e),Array.isArray(e))for(u=0;u<e.length;u++)c(e[u],u,u,i,e,d,l);else{var g=Object.keys(e);for(u=0;u<g.length;u++){var f=g[u];c(e[f],f,u,i,e,d,l)}}i.pop()}}function d(e,t){return e<t?-1:e>t?1:0}function l(e,t,n,s){void 0===s&&(s=i());var a,c=u(e,"",0,[],void 0,0,s)||e;try{a=0===o.length?JSON.stringify(c,t,n):JSON.stringify(c,g(t),n)}catch(e){return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;0!==r.length;){var d=r.pop();4===d.length?Object.defineProperty(d[0],d[1],d[3]):d[0][d[1]]=d[2]}}return a}function u(e,o,i,s,c,l,g){var f;if(l+=1,"object"==typeof e&&null!==e){for(f=0;f<s.length;f++)if(s[f]===e)return void a(n,e,o,c);try{if("function"==typeof e.toJSON)return}catch(e){return}if(void 0!==g.depthLimit&&l>g.depthLimit)return void a(t,e,o,c);if(void 0!==g.edgesLimit&&i+1>g.edgesLimit)return void a(t,e,o,c);if(s.push(e),Array.isArray(e))for(f=0;f<e.length;f++)u(e[f],f,f,s,e,l,g);else{var h={},p=Object.keys(e).comrt(d);for(f=0;f<p.length;f++){var v=p[f];u(e[v],v,f,s,e,l,g),h[v]=e[v]}if(void 0===c)return h;r.push([c,o,e]),c[o]=h}s.pop()}}function g(e){return e=void 0!==e?e:function(e,t){return t},function(t,n){if(o.length>0)for(var r=0;r<o.length;r++){var i=o[r];if(i[1]===t&&i[0]===n){n=i[2],o.splice(r,1);break}}return e.call(this,t,n)}}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};return(()=>{"use strict";n.r(r);var e=n(422),t=n(395),o=n(788),i=n(554),s=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};const a="$$CHARGERWALLET_DEBUG_LOGGER";var c=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};const d=a,l={formatArgs:function(e){if(e[0]=`${(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")}+${l.humanize(this.diff)}`,!this.useColors)return;const t=`color: ${this.color}`;e.splice(1,0,t,"color: inherit");let n=0,r=0;e[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(n+=1,"%c"===e&&(r=n))})),e.splice(r,0,t)},save:function(e){return c(this,void 0,void 0,(function*(){try{e?yield l.storage.setItem(d,e):yield l.storage.removeItem(d)}catch(e){console.error("debug logger storage error",e)}}))},load:function(){return c(this,void 0,void 0,(function*(){let e;try{e=yield l.storage.getItem(d)}catch(e){console.error("debug logger storage error",e)}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e}))},useColors:function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))}};l.storage=function(){try{return"undefined"!=typeof global&&global.$$chargerwalletAppStorage?global.$$chargerwalletAppStorage:"undefined"!=typeof window&&window.localStorage?window.localStorage:(console.warn("debugLogger init warning, neither `global.$$chargerwalletAppStorage` nor `window.localStorage` found."),{getItem(){return c(this,void 0,void 0,(function*(){return""}))},setItem(){return c(this,void 0,void 0,(function*(){}))},removeItem(){return c(this,void 0,void 0,(function*(){}))}})}catch(e){console.error("debug logger storage error",e)}}(),l.humanize=i,l.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),l.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],l.log=(...e)=>{console.debug?console.debug(...e):console.log&&console.log(...e)};const u=l;const g=function(){return e=this,t=void 0,r=function*(){return function(e){return s(this,void 0,void 0,(function*(){function t(e){let r,o,i,s=null;function a(...e){if(!a.enabled)return;const n=a,o=Number(new Date),i=o-(r||o);n.diff=i,n.prev=r,n.curr=o,r=o,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let s=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((r,o)=>{if("%%"===r)return"%";s++;const i=t.formatters[o];if("function"==typeof i){const t=e[s];r=i.call(n,t),e.splice(s,1),s--}return r})),t.formatArgs.call(n,e),(n.log||t.log).apply(n,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=n,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(o!==t.namespaces&&(o=t.namespaces,i=t.enabled(e)),i),set:e=>{s=e}}),"function"==typeof t.init&&t.init(a),a}function n(e,n){const r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function r(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names.map(r),...t.skips.map(r).map((e=>`-${e}`))].join(",");return t.enable(""),e},t.enable=function(e){return s(this,void 0,void 0,(function*(){let n;yield t.save(e),t.namespaces=e,t.names=[],t.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp(`^${e.substr(1)}$`)):t.names.push(new RegExp(`^${e}$`)))}))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=i,t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={j(e){try{return JSON.stringify(e)}catch(e){return`[UnexpectedJSONParseError]: ${e.message}`}}},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]};const o=yield t.load();return yield t.enable(o),t}))}(u)},new((n=void 0)||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}));var e,t,n,r};function f(...e){"undefined"!=typeof localStorage&&localStorage.getItem(a)&&console.error(...e)}const h={_isFakeLogger:!0,log:(...e)=>{},warn:(...e)=>{},error:(...e)=>{},debug:(...e)=>{},info:(...e)=>{},trace:(...e)=>{}};class p{constructor(){this._debug={enable(e){}},this._externalLogger=h,this._createExternalLog=e=>(...t)=>{const n=this._externalLogger;if(n)return n.log(e,...t)},this.jsBridge=this._createExternalLog("jsBridge >>"),this.providerBase=this._createExternalLog("providerBase >>"),this.extInjected=this._createExternalLog("extInjected >>"),this.extContentScripts=this._createExternalLog("extContentScripts >>"),this.webview=this._createExternalLog("webview >>"),this.desktopInjected=this._createExternalLog("desktopInjected >>")}_attachExternalLogger(e){e&&(this._externalLogger=e)}_createDebugInstance(e){}}const v=new p,m=new class extends p{constructor(){super(),this._debugInstanceCreatedMap={},g().then((e=>this._debug=e))}_createDebugInstance(e){if(!this._debugInstanceCreatedMap[e]&&(this._debugInstanceCreatedMap[e]=!0,e&&this._debug&&"function"==typeof this._debug)){const t=this._debug(e),n=this[e];this[e]=(...e)=>{t(...e),n&&"function"==typeof n&&n(...e)}}}};var y,b;!function(e){e.RESPONSE="RESPONSE",e.REQUEST="REQUEST"}(y||(y={})),function(e){e.ethereum="ethereum",e.conflux="conflux",e.comlana="solana",e.comllet="sollet",e.near="near",e.$private="$private"}(b||(b={}));var w=n(439);class C extends Error{constructor(e,t,n){if(!Number.isInteger(e))throw new Error('"code" must be an integer.');if(!t||"string"!=typeof t)throw new Error('"message" must be a nonempty string.');super(t),this.code=e,void 0!==n&&(this.data=n)}serialize(){const e={code:this.code,message:this.message};return void 0!==this.data&&(e.data=this.data),this.stack&&(e.stack=this.stack),e}toString(){return w(this.serialize(),x,2)}}class E extends C{constructor(e,t,n){if(!function(e){return Number.isInteger(e)&&e>=1e3&&e<=4999}(e))throw new Error('"code" must be an integer such that: 1000 <= code <= 4999');super(e,t,n)}}function x(e,t){if("[Circular]"!==t)return t}const j=4500,S={"-32700":{standard:"JSON RPC 2.0",message:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."},"-32600":{standard:"JSON RPC 2.0",message:"The JSON sent is not a valid Request object."},"-32601":{standard:"JSON RPC 2.0",message:"The method does not exist / is not available."},"-32602":{standard:"JSON RPC 2.0",message:"Invalid method parameter(s)."},"-32603":{standard:"JSON RPC 2.0",message:"Internal JSON-RPC error."},"-32000":{standard:"EIP-1474",message:"Invalid input."},"-32001":{standard:"EIP-1474",message:"Resource not found."},"-32002":{standard:"EIP-1474",message:"Resource unavailable."},"-32003":{standard:"EIP-1474",message:"Transaction rejected."},"-32004":{standard:"EIP-1474",message:"Method not supported."},"-32005":{standard:"EIP-1474",message:"Request limit exceeded."},4001:{standard:"EIP-1193",message:"User rejected the request."},4100:{standard:"EIP-1193",message:"The requested account and/or method has not been authorized by the user."},4200:{standard:"EIP-1193",message:"The requested method is not supported by this Web3 provider."},4900:{standard:"EIP-1193",message:"The provider is disconnected from all chains."},4901:{standard:"EIP-1193",message:"The provider is disconnected from the specified chain."},4500:{standard:"",message:"The request by this Web3 provider is timeout."}};function O(e,t="Unspecified error message. This is a bug, please report it."){if(Number.isInteger(e)){const t=e.toString();if(n=S,r=t,Object.prototype.hasOwnProperty.call(n,r))return S[t].message;if(function(e){return e>=-32099&&e<=-32e3}(e))return"Unspecified server error."}var n,r;return t}O(-32603);const k=e=>F(j,e);function F(e,t){const[n,r]=function(e){if(e){if("string"==typeof e)return[e];if("object"==typeof e&&!Array.isArray(e)){const{message:t,data:n}=e;if(t&&"string"!=typeof t)throw new Error("Must specify string message.");return[t||void 0,n]}}return[]}(t);return new E(e,n||O(e),r)}const I="0.0.7-alpha.0";const R="message",_="error";class P extends e{constructor(e={}){var t,n;super(),this.isExtUi=!1,this.isInjected=!1,this.sendAsString=!0,this.globalOnMessageEnabled=!0,this.providersHub={},this.globalOnMessage=e=>{return t=this,n=void 0,o=function*(){try{if(this.config.receiveHandler&&this.globalOnMessageEnabled){const t=yield this.config.receiveHandler(e,this);e.id&&this.response({id:e.id,scope:e.scope,remoteId:e.remoteId,data:t})}}catch(t){e.id&&e.type===y.REQUEST&&this.responseError({id:e.id,scope:e.scope,remoteId:e.remoteId,error:t}),this.emit(_,t)}},new((r=void 0)||(r=Promise))((function(e,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(s,a)}c((o=o.apply(t,n||[])).next())}));var t,n,r,o},this.version=I,this.remoteInfo={origin:"",remoteId:""},this.debugLogger=m,this.callbacks=[],this.callbackId=1,this.config=e,this.callbacksExpireTimeout=null!==(t=e.timeout)&&void 0!==t?t:6e4,this.debugLogger=e.debugLogger||m,this.sendAsString=null!==(n=e.sendAsString)&&void 0!==n?n:this.sendAsString,this.config.receiveHandler&&this.on(R,this.globalOnMessage),this.on(_,(e=>{var t;f("JsBridge ERROR: ",e,{code:null===(t=e)||void 0===t?void 0:t.code})})),this.rejectExpiredCallbacks()}attachProviderInstance(e){var t;const n=e.providerName;n&&(this.providersHub[n]=null!==(t=this.providersHub[n])&&void 0!==t?t:[],this.providersHub[n].push(e))}createCallbackId(){return this.callbackId+=1,this.callbackId}createPayload(e,{resolve:t,reject:n}){const{id:r,type:o}=e;if(t&&n&&r&&o===y.REQUEST){if(this.callbacks[r])throw new Error(`JsBridge ERROR: callback exists, id=${r}`);this.callbacks[r]={id:r,resolve:t,reject:n,created:Date.now()}}if(e.error){const t=e.error;e.error={code:t.code,message:t.message,data:t.data,stack:t.stack}}return null==e||delete e.resolve,null==e||delete e.reject,e}send({type:e,data:t,error:n,id:r,remoteId:o,sync:i=!1,scope:s}){const a=(a,c)=>{var d;let l=r;i||e!==y.REQUEST||(l=this.createCallbackId());try{const r=this.createPayload({id:l,data:t,error:n,type:e,origin:(null===(d=null===global||void 0===global?void 0:global.location)||void 0===d?void 0:d.origin)||"",remoteId:o,scope:s},{resolve:a,reject:c});let i=r;this.sendAsString&&(i=JSON.stringify(r)),this.debugLogger.jsBridge("send",r,"\r\n ------\x3e ",r.data),this.sendPayload(i)}catch(e){l?this.rejectCallback(l,e):this.emit(_,e)}};if(!i)return new Promise(a);a()}rejectCallback(e,t){this.processCallback({method:"reject",id:e,error:t})}resolveCallback(e,t){this.processCallback({method:"resolve",id:e,data:t})}processCallback({method:e,id:t,data:n,error:r}){const o=this.callbacks[t];o&&("reject"===e&&(o.reject&&o.reject(r),this.emit(_,r)),"resolve"===e&&o.resolve&&o.resolve(n),this.clearCallbackCache(t))}rejectExpiredCallbacks(){if(!this.callbacksExpireTimeout)return;const e=Date.now();for(const t in this.callbacks){const n=this.callbacks[t];if(n&&n.created&&e-n.created>this.callbacksExpireTimeout){const e=k();this.rejectCallback(t,e)}}setTimeout((()=>{this.rejectExpiredCallbacks()}),this.callbacksExpireTimeout)}clearCallbackCache(e){delete this.callbacks[e]}receive(e="",n){var r,i;let s={data:null};if(t(e)&&(s=e),o(e))try{s=JSON.parse(e)}catch(l){throw this.emit(_,l),new Error("JsBridge ERROR: JSON.parse payloadReceived failed")}if(s.origin=null==n?void 0:n.origin,s.internal=Boolean(null==n?void 0:n.internal),(null==n?void 0:n.internal)&&this.isExtUi&&function(e){const t=e;return Boolean(t.name)&&["chargerwallet-provider-eth","chargerwallet-provider-cfx","publicConfig"].includes(t.name)}(s))return;if(!s.origin&&!this.isInjected)throw f(null===(r=null==this?void 0:this.constructor)||void 0===r?void 0:r.name,"[payload.origin] is missing.",this),new Error("JsBridge ERROR: receive message [payload.origin] is required.");if(!s.internal&&!s.scope)throw new Error("JsBridge ERROR: receive message [payload.scope] is required for non-internal method call.");this.debugLogger.jsBridge("receive",s,{sender:n},"\r\n -----\x3e ",null===(i=s.data)||void 0===i?void 0:i.result,"\r\n -----\x3e ",s.data);const{type:a,id:c,data:d,error:l,origin:u,remoteId:g}=s;if(this.remoteInfo={origin:u,remoteId:g},a===y.RESPONSE){if(null==c)throw new Error("JsBridge ERROR: parameter [id] is required in JsBridge.receive() when REQUEST type message");if(this.callbacks[c])try{l?this.rejectCallback(c,l):this.resolveCallback(c,d)}catch(e){this.emit(_,e)}}else{if(a!==y.REQUEST)throw new Error(`JsBridge ERROR: payload type not support yet (type=${a||"undefined"})`);{const e=Object.assign(Object.assign({},s),{created:Date.now()});this.emit(R,e)}}}requestSync({data:e,scope:t,remoteId:n}){this.send({id:void 0,type:y.REQUEST,scope:t,data:e,remoteId:n,sync:!0})}request(e){const{data:t,remoteId:n,scope:r}=e;return void 0===t&&console.warn("JsBridge ERROR: data required. Call like `bridge.request({ data: {...} });`"),this.send({type:y.REQUEST,data:t,remoteId:n,sync:!1,scope:r})}response({id:e,data:t,remoteId:n,scope:r}){this.send({type:y.RESPONSE,data:t,id:e,remoteId:n,scope:r,sync:!0})}responseError({id:e,error:t,scope:n,remoteId:r}){this.send({type:y.RESPONSE,error:t,id:e,remoteId:r,scope:n,sync:!0})}}var L=n(920),N=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};function $(e){return new Promise(((t,n)=>{try{const n=document.createElement("img");n.onload=()=>t(!0),n.onerror=()=>t(!1),n.src=e}catch(e){n(e)}}))}function A(e){const{document:t}=e,n=t.querySelector('head > meta[property="og:site_name"]');if(n)return n.content;const r=t.querySelector('head > meta[name="title"]');return r?r.content:t.title&&t.title.length>0?t.title:window.location.hostname}function T(e){return N(this,void 0,void 0,(function*(){const{document:t}=e,n=t.querySelectorAll('head > link[rel~="icon"]');for(const e of n)if(e&&(yield $(e.href)))return e.href;return null}))}const B={getSiteMetadata:function(){return N(this,void 0,void 0,(function*(){return{name:A(window),icon:yield T(window)}}))},getSiteIcon:T,getSiteName:A,imgExists:$};var J=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};class M extends e{constructor(e){var t,n,r;if(super(),this.version=I,this.isChargerWallet=!0,this.debugLogger=v,this.logger=h,!e.bridge)throw new Error("ProviderBase init error: bridge required.");this.config=e,this.bridge=e.bridge,this.logger=e.logger||h,this.debugLogger=(null===(t=this.bridge)||void 0===t?void 0:t.debugLogger)||v,null===(r=null===(n=this.bridge)||void 0===n?void 0:n.debugLogger)||void 0===r||r._attachExternalLogger(this.logger),setTimeout((()=>{this.bridge.attachProviderInstance(this)}),0),e.shouldSendMetadata&&this.sendSiteMetadata()}configDebugLogger(e){try{if(!e||!this.bridge.debugLogger)return;const t=this.bridge.debugLogger;(e.enabledKeys||[]).forEach((e=>{t._createDebugInstance(e)})),e.config&&t._debug.enable(e.config),window.$chargerwallet=window.$chargerwallet||{},window.$chargerwallet.$debugLogger=t}catch(e){f("configDebugLogger ERROR:",e)}}getConnectWalletInfo({timeout:e=3e3}={}){return J(this,void 0,void 0,(function*(){return new Promise(((t,n)=>J(this,void 0,void 0,(function*(){const n=setTimeout((()=>{t(null)}),e);try{const e=yield this.bridgeRequest({method:"wallet_getConnectWalletInfo",params:[{time:Date.now()}]});e&&(e.providerState=e.providerState||{}),e&&e.debugLoggerConfig&&this.configDebugLogger(e.debugLoggerConfig),e&&e.walletInfo&&(window.$chargerwallet=window.$chargerwallet||{},window.$chargerwallet.$walletInfo=e.walletInfo),t(e||null)}catch(e){f("getConnectWalletInfo: ERROR",e),t(null)}finally{clearTimeout(n)}}))))}))}bridgeRequest(e,t){return J(this,void 0,void 0,(function*(){let n=!1;t&&L(t)&&(n=!0);try{const r={data:null!=e?e:{},scope:this.providerName};this.debugLogger.providerBase("bridgeRequest:",r,"\r\n -----\x3e ",r.data);const o=yield this.bridge.request(r),i=o?o.result:void 0;return t&&n&&t(null,i),this.debugLogger.providerBase("bridgeRequest RETURN:",{req:r,res:o},"\r\n -----\x3e ",r.data,"\r\n -----\x3e ",i),i}catch(e){throw t&&n&&t(e),e}}))}sendSiteMetadata(){return J(this,void 0,void 0,(function*(){const e=yield B.getSiteMetadata();return yield this.bridgeRequest({method:"wallet_sendSiteMetadata",params:e})}))}}function q(e,t){const n=(null==t?void 0:t.providersHub)||window.$chargerwallet,r=e.scope,o=e.data;if(!r)return void f("providerName (scope) is required in injectedProviderReceiveHandler.");const i=[].concat(n[r]).filter(Boolean);i&&i.length?i.forEach((e=>{e&&e.emit&&e.emit("message_low_level",o)})):f(`[${r}] provider is NOT injected to document or bridge.`)}class U extends P{constructor(){super(...arguments),this.sendAsString=!0,this.isInjected=!0}sendPayload(e){window.ReactNativeWebView&&window.ReactNativeWebView.postMessage(e)}}class D extends M{constructor(){super(...arguments),this.providerName=b.$private}}class z extends M{constructor(){super(...arguments),this.providerName=b.ethereum}}var H,Q;H=()=>new U({receiveHandler:q}),window.global=window.global||window||window.globalThis,window.global=window.global||window||window.globalThis,(null===(Q=null===window||void 0===window?void 0:window.$chargerwallet)||void 0===Q?void 0:Q.jsBridge)||(window.$chargerwallet=window.$chargerwallet||{},window.$chargerwallet.jsBridge=H(),"undefined"!=typeof localStorage&&localStorage.getItem(a)&&console.log("===== jsBridge injected success! >>>>> ",performance.now())),window.$chargerwallet.jsBridge,function(){var e,t;if(!(null===(e=null===window||void 0===window?void 0:window.$chargerwallet)||void 0===e?void 0:e.jsBridge))throw new Error("ChargerWallet jsBridge not found.");const n=null===(t=null===window||void 0===window?void 0:window.$chargerwallet)||void 0===t?void 0:t.jsBridge,r=new z({bridge:n}),o=new D({bridge:n}),i=Object.assign(Object.assign({},window.$chargerwallet),{jsBridge:n,ethereum:r,$private:o,solana:null,conflux:null,sollet:null});window.$chargerwallet=i,window.ethereum=r,window.dispatchEvent(new Event("ethereum#initialized"))}()})(),r})()}));